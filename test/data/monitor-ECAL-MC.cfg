process ECALDQM = {

    module ecalUncalibHit = ecalFixedAlphaBetaFitUncalibRecHit from "RecoLocalCalo/EcalRecProducers/data/ecalFixedAlphaBetaFitUncalibRecHit.cfi"

    replace ecalUncalibHit.MinAmplBarrel = 12.
    replace ecalUncalibHit.MinAmplEndcap = 16.

#     module ecalUncalibHit = ecalWeightUncalibRecHit from "RecoLocalCalo/EcalRecProducers/data/ecalWeightUncalibRecHit.cfi"

    replace ecalUncalibHit.EBdigiCollection = ecalDigis:ebDigis
    replace ecalUncalibHit.EEdigiCollection = ecalDigis:eeDigis

include "RecoLocalCalo/EcalRecProducers/data/ecalRecHit.cfi"

    replace ecalRecHit.EBuncalibRecHitCollection = ecalUncalibHit:EcalUncalibRecHitsEB
    replace ecalRecHit.EEuncalibRecHitCollection = ecalUncalibHit:EcalUncalibRecHitsEE

include "Geometry/CaloEventSetup/data/CaloGeometry.cfi"
include "Geometry/CaloEventSetup/data/EcalTrigTowerConstituents.cfi"
include "Geometry/CMSCommonData/data/cmsIdealGeometryXML.cfi"

include "Geometry/EcalMapping/data/EcalMapping.cfi"
include "Geometry/EcalMapping/data/EcalMappingRecord.cfi"

include "DQM/EcalBarrelMonitorModule/data/EcalBarrelMonitorModule.cfi"

    replace ecalBarrelMonitorModule.mergeRuns = true

    replace ecalBarrelMonitorModule.EBDigiCollection = ecalDigis:ebDigis

    replace ecalBarrelMonitorModule.runType = 3 # MTCC/PHYSICS

include "DQM/EcalBarrelMonitorTasks/data/EcalBarrelMonitorTasks.cfi"

include "DQM/EcalBarrelMonitorTasks/data/mergeRuns.cff"

    replace ecalBarrelMonitorModule.EcalTrigPrimDigiCollection = ecalTriggerPrimitiveDigis

    replace ecalBarrelOccupancyTask.EBDigiCollection = ecalDigis:ebDigis
    replace ecalBarrelOccupancyTask.EcalTrigPrimDigiCollection = ecalTriggerPrimitiveDigis
    replace ecalBarrelPedestalOnlineTask.EBDigiCollection = ecalDigis:ebDigis

include "DQM/EcalBarrelMonitorClient/data/EcalBarrelMonitorClient.cfi"

    replace ecalBarrelMonitorClient.maskFile = "maskfile-EB.dat"
    replace ecalBarrelMonitorClient.mergeRuns = true
    replace ecalBarrelMonitorClient.location = "H4"
    replace ecalBarrelMonitorClient.baseHtmlDir = "HTML_EB"
    replace ecalBarrelMonitorClient.enabledClients = { "Integrity",
	"Occupancy",
	"PedestalOnline",
	"Timing",
	"Cluster",
	"Summary" }

    module preScaler = Prescaler{ int32 prescaleFactor = 1 }

    module dqmInfoEB = DQMEventInfo{
	untracked string subSystemFolder = "EcalBarrel"
    }

    module dqmSaverEB = DQMFileSaver{
	untracked string convention = "Online"
	untracked string dirName = "."
	untracked string fileName = "EcalBarrel"
    }

include "DQM/EcalEndcapMonitorModule/data/EcalEndcapMonitorModule.cfi"

    replace ecalEndcapMonitorModule.mergeRuns = true

    replace ecalEndcapMonitorModule.EEDigiCollection = ecalDigis:eeDigis

    replace ecalEndcapMonitorModule.runType = 3 # MTCC/PHYSICS

include "DQM/EcalEndcapMonitorTasks/data/EcalEndcapMonitorTasks.cfi"

include "DQM/EcalEndcapMonitorTasks/data/mergeRuns.cff"

    replace ecalEndcapMonitorModule.EcalTrigPrimDigiCollection = ecalTriggerPrimitiveDigis

    replace ecalEndcapOccupancyTask.EEDigiCollection = ecalDigis:eeDigis
    replace ecalEndcapOccupancyTask.EcalTrigPrimDigiCollection = ecalTriggerPrimitiveDigis
    replace ecalEndcapPedestalOnlineTask.EEDigiCollection = ecalDigis:eeDigis

include "DQM/EcalEndcapMonitorClient/data/EcalEndcapMonitorClient.cfi"

    replace ecalEndcapMonitorClient.maskFile = "maskfile-EE.dat"
    replace ecalEndcapMonitorClient.mergeRuns = true
    replace ecalEndcapMonitorClient.location = "H4"
    replace ecalEndcapMonitorClient.baseHtmlDir = "HTML_EE"
    replace ecalEndcapMonitorClient.enabledClients = { "Integrity",
	"Occupancy",
	"PedestalOnline",
	"Timing",
	"Cluster",
	"Summary" }

    module dqmInfoEE = DQMEventInfo{
	untracked string subSystemFolder = "EcalEndcap"
    }

    module dqmSaverEE = DQMFileSaver{
	untracked string convention = "Online"
	untracked string dirName = "."
	untracked string fileName = "EcalEndcap"
    }
    
include "RecoEcal/EgammaClusterProducers/data/ecalClusteringSequence.cff"

    sequence ecalDataSequence = {
	preScaler,
	ecalUncalibHit,
	ecalRecHit,
	islandBasicClusters,
	islandSuperClusters,
	hybridSuperClusters
    }

    sequence ecalBarrelMonitorSequence = { 
	ecalBarrelMonitorModule,
	dqmInfoEB,
	ecalBarrelMonitorClient,
	dqmSaverEB }

    sequence ecalEndcapMonitorSequence = { 
	ecalEndcapMonitorModule,
	dqmInfoEE,
	ecalEndcapMonitorClient,
	dqmSaverEE }
    
    path p = { ecalDataSequence,
	ecalBarrelMonitorSequence, 
	ecalEndcapMonitorSequence  }

    endpath q = { ecalBarrelDefaultTasksSequence, ecalBarrelClusterTask,
	ecalEndcapDefaultTasksSequence, ecalEndcapClusterTask }
    
#     untracked PSet maxEvents = {untracked int32 input = 150}
    untracked PSet maxEvents = {untracked int32 input = 150}
    source = PoolSource{
#---
        untracked vstring fileNames = { '/store/users/dellaric/data/cosmics_ZS_noSR_RAW.root' }
#---
    }

    es_source = EcalTrivialConditionRetriever{
	untracked double adcToGeVEBConstant = 0.035
	untracked double adcToGeVEEConstant = 0.060
	untracked vdouble amplWeights = { -0.333, -0.333, -0.333,
	    0.000,  0.000,  1.000,
	    0.000,  0.000,  0.000,  0.000 }
	untracked vdouble pedWeights  = {  0.333,  0.333,  0.333,
	    0.000,  0.000,  0.000,
	    0.000,  0.000,  0.000,  0.000 }
	untracked vdouble jittWeights = {  0.041,  0.041,  0.041,
	    0.000,  1.325, -0.050,
	    -0.504, -0.502, -0.390,  0.000 }
    }

include "CalibCalorimetry/EcalLaserCorrection/data/ecalLaserCorrectionService.cfi"

    service = MessageLogger{
	untracked vstring destinations = { "cout" }
	untracked vstring categories = { "EcalBarrelMonitorModule" }
	untracked PSet cout = {
	    untracked string threshold = "WARNING"
	    untracked PSet default                        = { untracked int32 limit = 0 }
	    untracked PSet EcalBarrelMonitorModule        = { untracked int32 limit = 0 }
	    untracked bool noTimeStamps = true
	    untracked bool noLineBreaks = true
	}
    }

include "DQMServices/Core/data/DQM.cfg"

    replace DQM.collectorHost = ""

}
